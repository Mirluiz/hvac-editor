{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/2d/controllers/canvas.controller.ts","app/2d/index.ts","app/2d/models/canvas.model.ts","app/2d/views/canvas.view.ts","app/app.ts","app/main.ts"],"names":[],"mappings":"AAAA;;;;;;;ACAA,IAAA,gBAAA,gBAAA,QAAA,sBAAA,CAAA,CAAA;AACA,IAAA,iBAAA,gBAAA,QAAA,wBAAA,CAAA,CAAA;AAEA,IAAA,mBAAA,aAAA,YAAA;AAIE,aAAA,gBAAA,GAAA;AACE,aAAK,KAAL,GAAa,IAAI,eAAA,OAAJ,EAAb;AACA,aAAK,IAAL,GAAY,IAAI,cAAA,OAAJ,CAAe,KAAK,KAApB,CAAZ;AACA,YAAI,KAAK,IAAL,CAAU,SAAd,EAAyB;AACvB,iBAAK,IAAL,CAAU,SAAV,CAAoB,gBAApB,CACE,WADF,EAEE,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAFF;AAIA,iBAAK,IAAL,CAAU,SAAV,CAAoB,gBAApB,CACE,WADF,EAEE,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAFF;AAIA,iBAAK,IAAL,CAAU,SAAV,CAAoB,gBAApB,CAAqC,SAArC,EAAgD,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAhD;AACA,iBAAK,IAAL,CAAU,SAAV,CAAoB,gBAApB,CAAqC,OAArC,EAA8C,KAAK,UAAL,CAAgB,IAAhB,CAAqB,IAArB,CAA9C;AACD;AACF;AAED,qBAAA,SAAA,CAAA,UAAA,GAAA,UAAW,CAAX,EAAwB;AACtB,aAAK,KAAL,CAAW,KAAX,CAAiB,MAAjB,IAA2B,CAAC,KAAK,IAAL,CAAU,EAAE,MAAZ,CAAD,GAAuB,IAAlD;AACA,aAAK,KAAL,CAAW,KAAX,CAAiB,MAAjB,GAA0B,KAAK,GAAL,CACxB,KAAK,GAAL,CAAS,GAAT,EAAc,KAAK,KAAL,CAAW,KAAX,CAAiB,MAA/B,CADwB,EAExB,CAFwB,CAA1B;AAIA,aAAK,KAAL,CAAW,KAAX,CAAiB,KAAjB,GAAyB;AACvB,eAAG,EAAE,OADkB;AAEvB,eAAG,EAAE;AAFkB,SAAzB;AAKA,YAAI,MAAgC,SAAS,aAAT,CAAuB,SAAvB,CAApC;AACA,YAAI,CAAJ,EAAO,CAAP;AAEA,YAAI,GAAJ,EAAS;AACP,gBAAI,IAAI,KAAR;AACA,gBAAI,IAAI,MAAR;AACA,oBAAQ,GAAR,CACE,IADF,EAEE,CAFF,EAGE,IAAI,KAAK,KAAL,CAAW,KAAX,CAAiB,MAHvB,EAIE,KAAK,KAAL,CAAW,KAAX,CAAiB,MAJnB,EAKE,CAAC,IAAI,KAAK,KAAL,CAAW,KAAX,CAAiB,MAArB,GAA8B,CAA/B,KAAqC,EAAE,OAAF,GAAY,CAAjD,CALF;AAOA,iBAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,IACE,CAAC,IAAI,KAAK,KAAL,CAAW,KAAX,CAAiB,MAArB,GAA8B,CAA/B,KAAqC,EAAE,OAAF,GAAY,CAAjD,CADF;AAEA,iBAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,IACE,CAAC,IAAI,KAAK,KAAL,CAAW,KAAX,CAAiB,MAArB,GAA8B,CAA/B,KAAqC,EAAE,OAAF,GAAY,CAAjD,CADF;AAED;AAED,aAAK,IAAL,CAAU,IAAV;AACD,KA/BD;AAiCA,qBAAA,SAAA,CAAA,SAAA,GAAA,UAAU,CAAV,EAAkB;AAChB,aAAK,KAAL,CAAW,OAAX,GAAqB,IAArB;AACD,KAFD;AAIA,qBAAA,SAAA,CAAA,SAAA,GAAA,UAAU,CAAV,EAAuB;AACrB,YAAI,CAAC,KAAK,KAAL,CAAW,KAAhB,EAAuB;AACrB,iBAAK,KAAL,CAAW,KAAX,GAAmB;AACjB,mBAAG,EAAE,OADY;AAEjB,mBAAG,EAAE;AAFY,aAAnB;AAID,SALD,MAKO;AACL,iBAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,GAAqB,EAAE,OAAvB;AACA,iBAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,GAAqB,EAAE,OAAvB;AACD;AAED,YAAI,KAAK,KAAL,CAAW,OAAf,EAAwB;AACtB,gBAAI,KAAK,KAAL,CAAW,MAAf,EAAuB;AACrB,qBAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,IAAuB,EAAE,SAAzB;AACA,qBAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,IAAuB,EAAE,SAAzB;AACD,aAHD,MAGO;AACL,qBAAK,KAAL,CAAW,MAAX,GAAoB;AAClB,uBAAG,CADe;AAElB,uBAAG;AAFe,iBAApB;AAID;AACF;AAED,aAAK,IAAL,CAAU,IAAV;AACD,KAxBD;AA0BA,qBAAA,SAAA,CAAA,OAAA,GAAA,UAAQ,CAAR,EAAgB;AACd,aAAK,KAAL,CAAW,OAAX,GAAqB,KAArB;AACD,KAFD;AAGF,WAAA,gBAAA;AAAC,CAvFD,EAAA;AAyFA,QAAA,OAAA,GAAe,gBAAf;;;;;;;;;AC5FA,IAAA,sBAAA,gBAAA,QAAA,iCAAA,CAAA,CAAA;AAEA,IAAA,aAAA,aAAA,YAAA;AAAA,aAAA,UAAA,GAAA;AACI,aAAA,MAAA,GAA2B,IAAI,oBAAA,OAAJ,EAA3B;AACH;AAAD,WAAA,UAAA;AAAC,CAFD,EAAA;AAIA,QAAA,OAAA,GAAe,UAAf;;;;;;ACJA,IAAA,cAAA,aAAA,YAAA;AAAA,aAAA,WAAA,GAAA;AACE,aAAA,KAAA,GAAqB,IAArB;AACA,aAAA,KAAA,GAGI;AACF,oBAAQ,CADN;AAEF,mBAAO;AAFL,SAHJ;AAOA,aAAA,OAAA,GAAmB,KAAnB;AACA,aAAA,QAAA,GAA0B,IAA1B;AACA,aAAA,MAAA,GAAe,EAAE,GAAG,CAAL,EAAQ,GAAG,CAAX,EAAf;AACA,aAAA,MAAA,GAAkB;AAChB,kBAAM;AACJ,sBAAM;AADF,aADU;AAIhB,iBAAK;AACH,sBAAM,IADH;AAEH,sBAAM;AAFH;AAJW,SAAlB;AASD;AAAD,WAAA,WAAA;AAAC,CArBD,EAAA;AAiCA,QAAA,OAAA,GAAe,WAAf;;;;;;AChCA,IAAA,aAAA,aAAA,YAAA;AAIE,aAAA,UAAA,CAAY,KAAZ,EAA8B;AAC5B,aAAK,KAAL,GAAa,KAAb;AACA,aAAK,SAAL,GAAiB,SAAS,aAAT,CAAuB,SAAvB,CAAjB;AACA,aAAK,IAAL;AACD;AAED,eAAA,SAAA,CAAA,IAAA,GAAA,YAAA;AACE,aAAK,mBAAL;AACD,KAFD;AAIA,eAAA,SAAA,CAAA,IAAA,GAAA,YAAA;AACE,aAAK,KAAL;AACA;AACA,aAAK,QAAL;AACA,aAAK,QAAL;AACA,aAAK,SAAL;AACD,KAND;AAQA,eAAA,SAAA,CAAA,KAAA,GAAA,YAAA;;AACE,YAAM,MAAM,CAAA,KAAA,KAAK,SAAL,MAAc,IAAd,IAAc,OAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,GAAE,UAAF,CAAa,IAAb,CAA1B;AAEA,YAAI,CAAC,GAAD,IAAQ,CAAC,KAAK,KAAL,CAAW,KAApB,IAA6B,CAAC,KAAK,SAAvC,EAAkD;AAElD,YAAI,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,KAAK,SAAL,CAAe,KAAnC,EAA0C,KAAK,SAAL,CAAe,MAAzD;AACD,KAND;AAQA,eAAA,SAAA,CAAA,SAAA,GAAA,YAAA;;AACE,YAAM,MAAM,CAAA,KAAA,KAAK,SAAL,MAAc,IAAd,IAAc,OAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,GAAE,UAAF,CAAa,IAAb,CAA1B;AAEA,YAAI,CAAC,GAAD,IAAQ,CAAC,KAAK,KAAL,CAAW,KAAxB,EAA+B;AAE/B,YAAI,IAAJ;AAEA,YAAI,SAAJ;AACA,YAAI,WAAJ,GAAkB,KAAlB;AACA,YAAI,SAAJ,GAAgB,CAAhB;AACA,YAAI,GAAJ,CAAQ,KAAK,KAAL,CAAW,KAAX,CAAiB,CAAzB,EAA4B,KAAK,KAAL,CAAW,KAAX,CAAiB,CAA7C,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,IAAI,KAAK,EAA/D;AAEA,YAAI,OAAJ;AACD,KAbD;AAeA,eAAA,SAAA,CAAA,OAAA,GAAA,YAAA;;AACE,YAAM,MAAM,CAAA,KAAA,KAAK,SAAL,MAAc,IAAd,IAAc,OAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,GAAE,UAAF,CAAa,IAAb,CAA1B;AAEA,YAAI,CAAC,GAAD,IAAQ,CAAC,KAAK,KAAL,CAAW,KAApB,IAA6B,CAAC,KAAK,SAAvC,EAAkD;AAClD,YAAI,CAAC,KAAK,KAAL,CAAW,MAAX,CAAkB,GAAlB,CAAsB,IAA3B,EAAiC;AAEjC,YAAI,IAAJ;AAEA,YAAI,SAAJ;AACA,YAAI,SAAJ,GAAgB,CAAhB;AAEA,YAAI,OAAO,KAAK,KAAL,CAAW,MAAX,CAAkB,GAAlB,CAAsB,IAAtB,GAA6B,KAAK,KAAL,CAAW,KAAX,CAAiB,MAAzD;AACA,YAAI,IAAI,KAAK,SAAL,CAAe,MAAvB;AACA,YAAI,IAAI,KAAK,SAAL,CAAe,KAAvB;AACA,YAAI,YAAkB;AACpB,eAAG,KAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,GAAsB,IADL;AAEpB,eAAG,KAAK,KAAL,CAAW,MAAX,CAAkB,CAAlB,GAAsB;AAFL,SAAtB;AAKA;AACA,YAAI,KAAK,CAAT;AACA,YAAI,OAAO,IAAI,IAAf;AACA,eAAO,MAAM,IAAb,EAAmB;AACjB,gBAAI,OAAa,EAAE,GAAG,OAAO,EAAP,GAAY,UAAU,CAA3B,EAA8B,GAAG,CAAjC,EAAjB;AACA,gBAAI,KAAW,EAAE,GAAG,OAAO,EAAP,GAAY,UAAU,CAA3B,EAA8B,GAAG,CAAjC,EAAf;AAEA,gBAAI,MAAJ,CAAW,KAAK,CAAhB,EAAmB,KAAK,CAAxB;AACA,gBAAI,MAAJ,CAAW,GAAG,CAAd,EAAiB,GAAG,CAApB;AACA;AACD;AAED;AACA,YAAI,KAAK,CAAT;AACA,YAAI,OAAO,IAAI,IAAf;AACA,eAAO,MAAM,IAAb,EAAmB;AACjB,gBAAI,OAAa,EAAE,GAAG,CAAL,EAAQ,GAAG,OAAO,EAAP,GAAY,UAAU,CAAjC,EAAjB;AACA,gBAAI,KAAW,EAAE,GAAG,CAAL,EAAQ,GAAG,OAAO,EAAP,GAAY,UAAU,CAAjC,EAAf;AAEA,gBAAI,MAAJ,CAAW,KAAK,CAAhB,EAAmB,KAAK,CAAxB;AACA,gBAAI,MAAJ,CAAW,GAAG,CAAd,EAAiB,GAAG,CAApB;AAEA;AACD;AAED,YAAI,MAAJ;AACA,YAAI,OAAJ;AACD,KA9CD;AAgDA,eAAA,SAAA,CAAA,QAAA,GAAA,YAAA;;AACE,YAAM,MAAM,CAAA,KAAA,KAAK,SAAL,MAAc,IAAd,IAAc,OAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,GAAE,UAAF,CAAa,IAAb,CAA1B;AAEA,YAAI,CAAC,GAAD,IAAQ,CAAC,KAAK,KAAL,CAAW,KAApB,IAA6B,CAAC,KAAK,SAAvC,EAAkD;AAClD,YAAI,CAAC,KAAK,KAAL,CAAW,MAAX,CAAkB,GAAlB,CAAsB,IAA3B,EAAiC;AAEjC,YAAI,IAAJ;AAEA,YAAI,SAAJ;AACA,YAAI,SAAJ,GAAgB,CAAhB;AAEA,YAAI,OAAO,KAAK,KAAL,CAAW,MAAX,CAAkB,GAAlB,CAAsB,IAAtB,GAA6B,KAAK,KAAL,CAAW,KAAX,CAAiB,MAAzD;AACA,YAAI,IAAI,KAAK,SAAL,CAAe,MAAvB;AACA,YAAI,IAAI,KAAK,SAAL,CAAe,KAAvB;AAEA;AACA,YAAI,KAAK,CAAT;AACA,YAAI,OAAO,IAAI,IAAf;AACA,eAAO,MAAM,IAAb,EAAmB;AACjB,gBAAI,OAAa,KAAK,mBAAL,CAAyB,OAAO,EAAhC,EAAoC,CAApC,CAAjB;AACA,gBAAI,KAAW,KAAK,mBAAL,CAAyB,OAAO,EAAhC,EAAoC,CAApC,CAAf;AAEA,gBAAI,MAAJ,CAAW,KAAK,CAAhB,EAAmB,KAAK,CAAxB;AACA,gBAAI,MAAJ,CAAW,GAAG,CAAd,EAAiB,GAAG,CAApB;AACA;AACD;AAED;AACA,YAAI,KAAK,CAAT;AACA,YAAI,OAAO,IAAI,IAAf;AACA,eAAO,MAAM,IAAb,EAAmB;AACjB,gBAAI,OAAa,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,OAAO,EAAnC,CAAjB;AACA,gBAAI,KAAW,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,OAAO,EAAnC,CAAf;AAEA,gBAAI,MAAJ,CAAW,KAAK,CAAhB,EAAmB,KAAK,CAAxB;AACA,gBAAI,MAAJ,CAAW,GAAG,CAAd,EAAiB,GAAG,CAApB;AAEA;AACD;AAED,YAAI,MAAJ;AACA,YAAI,OAAJ;AACD,KA1CD;AA4CA,eAAA,SAAA,CAAA,QAAA,GAAA,YAAA;;AACE,YAAM,MAAM,CAAA,KAAA,KAAK,SAAL,MAAc,IAAd,IAAc,OAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,GAAE,UAAF,CAAa,IAAb,CAA1B;AAEA,YAAI,CAAC,GAAD,IAAQ,CAAC,KAAK,KAAL,CAAW,KAApB,IAA6B,CAAC,KAAK,SAAvC,EAAkD;AAClD,YAAI,CAAC,KAAK,KAAL,CAAW,MAAX,CAAkB,IAAlB,CAAuB,IAA5B,EAAkC;AAElC,YAAI,IAAJ;AACA,YAAI,SAAJ;AAEA,YAAI,IAAI,KAAK,SAAL,CAAe,MAAvB;AACA,YAAI,IAAI,KAAK,SAAL,CAAe,KAAvB;AAEA,YAAI,SAAS,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,CAA5B,CAAb;AACA,YAAI,OAAO,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,CAA5B,CAAX;AACA,YAAI,SAAS,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,CAA5B,CAAb;AACA,YAAI,OAAO,KAAK,mBAAL,CAAyB,CAAzB,EAA4B,CAA5B,CAAX;AAEA,YAAI,MAAJ,CAAW,CAAX,EAAc,OAAO,CAArB;AACA,YAAI,MAAJ,CAAW,CAAX,EAAc,KAAK,CAAnB;AAEA,YAAI,MAAJ,CAAW,OAAO,CAAlB,EAAqB,CAArB;AACA,YAAI,MAAJ,CAAW,KAAK,CAAhB,EAAmB,CAAnB;AACA,YAAI,WAAJ,GAAkB,KAAlB;AAEA,YAAI,MAAJ;AACA,YAAI,OAAJ;AACD,KA1BD;AA4BA;AACA,eAAA,SAAA,CAAA,mBAAA,GAAA,UAAoB,CAApB,EAA+B,CAA/B,EAAwC;AACtC,YAAI,QAAQ,IAAZ;AAEA,YAAI,YAAY,UAAU,GAAV,EAAmB;AACjC,mBAAO;AACL,mBAAG,IAAI,CAAJ,GAAQ,MAAM,KAAN,CAAY,MAAZ,CAAmB,CADzB;AAEL,mBAAG,IAAI,CAAJ,GAAQ,MAAM,KAAN,CAAY,MAAZ,CAAmB;AAFzB,aAAP;AAID,SALe,CAKd,IALc,CAKT,IALS,CAAhB;AAOA,YAAI,QAAQ,SAAR,KAAQ,CAAU,GAAV,EAAmB;AAC7B,mBAAO;AACL,mBAAG,IAAI,CAAJ,GAAQ,MAAM,KAAN,CAAY,KAAZ,CAAkB,MADxB;AAEL,mBAAG,IAAI,CAAJ,GAAQ,MAAM,KAAN,CAAY,KAAZ,CAAkB;AAFxB,aAAP;AAID,SALD;AAOA,YAAI,IAAI,EAAE,GAAC,CAAH,EAAK,GAAC,CAAN,EAAR;AACA,YAAI,UAAU,CAAV,CAAJ;AACA,YAAI,MAAM,CAAN,CAAJ;AAEA,eAAO,CAAP;AACD,KAtBD;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,eAAA,SAAA,CAAA,mBAAA,GAAA,YAAA;AACE,YAAI,CAAC,KAAK,SAAV,EAAqB;AAErB,aAAK,SAAL,CAAe,KAAf,CAAqB,MAArB,GAA8B,OAA9B;AACA,aAAK,SAAL,CAAe,KAAf,CAAqB,KAArB,GAA6B,OAA7B;AACA,aAAK,SAAL,CAAe,MAAf,GAAwB,GAAxB;AACA,aAAK,SAAL,CAAe,KAAf,GAAuB,GAAvB;AACA,aAAK,SAAL,CAAe,KAAf,CAAqB,MAArB,GAA8B,iBAA9B;AACD,KARD;AASF,WAAA,UAAA;AAAC,CAhND,EAAA;AAkNA,QAAA,OAAA,GAAe,UAAf;;;;;;;;;ACrNA,IAAA,QAAA,gBAAA,QAAA,MAAA,CAAA,CAAA;AAEA,IAAA,MAAA,aAAA,YAAA;AAAA,aAAA,GAAA,GAAA;AACE,aAAA,GAAA,GAAqB,IAAI,MAAA,OAAJ,EAArB;AAID;AADC,QAAA,SAAA,CAAA,GAAA,GAAA,YAAA,CAAQ,CAAR;AACF,WAAA,GAAA;AAAC,CALD,EAAA;AAOA,QAAA,OAAA,GAAe,GAAf;;;;;;;;;ACTA,IAAA,QAAA,gBAAA,QAAA,OAAA,CAAA,CAAA;AAEA,IAAM,MAAM,IAAI,MAAA,OAAJ,EAAZ;AAEA,IAAI,GAAJ","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import CanvasView from \"../views/canvas.view\";\nimport CanvasModel from \"../models/canvas.model\";\n\nclass CanvasController {\n  view: CanvasView;\n  model: CanvasModel;\n\n  constructor() {\n    this.model = new CanvasModel();\n    this.view = new CanvasView(this.model);\n    if (this.view.container) {\n      this.view.container.addEventListener(\n        \"mousemove\",\n        this.mouseMove.bind(this)\n      );\n      this.view.container.addEventListener(\n        \"mousedown\",\n        this.mouseDown.bind(this)\n      );\n      this.view.container.addEventListener(\"mouseup\", this.mouseUp.bind(this));\n      this.view.container.addEventListener(\"wheel\", this.mouseWheel.bind(this));\n    }\n  }\n\n  mouseWheel(e: WheelEvent) {\n    this.model.scale.amount += -Math.sign(e.deltaY) * 0.01;\n    this.model.scale.amount = Math.min(\n      Math.max(0.5, this.model.scale.amount),\n      4\n    );\n    this.model.scale.coord = {\n      x: e.offsetX,\n      y: e.offsetY,\n    };\n\n    let _el: HTMLCanvasElement | null = document.querySelector(\"#editor\");\n    let w, h;\n\n    if (_el) {\n      w = _el.width;\n      h = _el.height;\n      console.log(\n        \"--\",\n        w,\n        w / this.model.scale.amount,\n        this.model.scale.amount,\n        (w / this.model.scale.amount - w) * (e.offsetX / w)\n      );\n      this.model.offset.x +=\n        (w / this.model.scale.amount - w) * (e.offsetX / w);\n      this.model.offset.y +=\n        (h / this.model.scale.amount - h) * (e.offsetY / h);\n    }\n\n    this.view.draw();\n  }\n\n  mouseDown(e: Event): void {\n    this.model.clicked = true;\n  }\n\n  mouseMove(e: MouseEvent): void {\n    if (!this.model.mouse) {\n      this.model.mouse = {\n        x: e.offsetX,\n        y: e.offsetY,\n      };\n    } else {\n      this.model.mouse.x = e.offsetX;\n      this.model.mouse.y = e.offsetY;\n    }\n\n    if (this.model.clicked) {\n      if (this.model.offset) {\n        this.model.offset.x += e.movementX;\n        this.model.offset.y += e.movementY;\n      } else {\n        this.model.offset = {\n          x: 0,\n          y: 0,\n        };\n      }\n    }\n\n    this.view.draw();\n  }\n\n  mouseUp(e: Event) {\n    this.model.clicked = false;\n  }\n}\n\nexport default CanvasController;\n","import CanvasController from \"./controllers/canvas.controller\";\n\nclass Controller {\n    canvas: CanvasController = new CanvasController()\n}\n\nexport default Controller\n","import { IVec } from \"../../geometry/vect\";\n\nclass CanvasModel {\n  mouse: IVec | null = null;\n  scale: {\n    amount: number,\n    coord: IVec | null\n  } = {\n    amount: 1,\n    coord: null\n  }\n  clicked: boolean = false;\n  keyboard: string | null = null;\n  offset: IVec = { x: 0, y: 0 };\n  config: IConfig = {\n    axis: {\n      show: true,\n    },\n    net: {\n      show: true,\n      step: 20,\n    },\n  };\n}\n\ninterface IConfig {\n  axis: {\n    show: boolean;\n  };\n  net: {\n    show: boolean;\n    step: 15 | 20 | 50;\n  };\n}\n\nexport default CanvasModel;\n","import { IVec } from \"../../geometry/vect\";\nimport CanvasModel from \"../models/canvas.model\";\n\nclass CanvasView {\n  model: CanvasModel;\n  container: HTMLCanvasElement | null;\n\n  constructor(model: CanvasModel) {\n    this.model = model;\n    this.container = document.querySelector(\"#editor\");\n    this.init();\n  }\n\n  init() {\n    this.initCanvasContainer();\n  }\n\n  draw() {\n    this.clear();\n    // this.drawNet();\n    this.drawNet1();\n    this.drawAxis();\n    this.drawMouse();\n  }\n\n  clear() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n\n    ctx.clearRect(0, 0, this.container.width, this.container.height);\n  }\n\n  drawMouse() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse) return;\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.strokeStyle = \"red\";\n    ctx.lineWidth = 2;\n    ctx.arc(this.model.mouse.x, this.model.mouse.y, 1, 0, 2 * Math.PI);\n\n    ctx.restore();\n  }\n\n  drawNet() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n    if (!this.model.config.net.show) return;\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.lineWidth = 1;\n\n    let step = this.model.config.net.step * this.model.scale.amount;\n    let h = this.container.height;\n    let w = this.container.width;\n    let netOffset: IVec = {\n      x: this.model.offset.x % step,\n      y: this.model.offset.y % step,\n    };\n\n    //x\n    let iV = 0;\n    let maxV = w / step;\n    while (iV <= maxV) {\n      let from: IVec = { x: step * iV + netOffset.x, y: 0 };\n      let to: IVec = { x: step * iV + netOffset.x, y: h };\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n      iV++;\n    }\n\n    //y\n    let iH = 0;\n    let maxH = h / step;\n    while (iH <= maxH) {\n      let from: IVec = { x: 0, y: step * iH + netOffset.y };\n      let to: IVec = { x: w, y: step * iH + netOffset.y };\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n\n      iH++;\n    }\n\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  drawNet1() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n    if (!this.model.config.net.show) return;\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.lineWidth = 1;\n\n    let step = this.model.config.net.step * this.model.scale.amount;\n    let h = this.container.height;\n    let w = this.container.width;\n\n    //x\n    let iV = 0;\n    let maxV = w / step;\n    while (iV <= maxV) {\n      let from: IVec = this.getWorldCoordinates(step * iV, 0);\n      let to: IVec = this.getWorldCoordinates(step * iV, h);\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n      iV++;\n    }\n\n    //y\n    let iH = 0;\n    let maxH = h / step;\n    while (iH <= maxH) {\n      let from: IVec = this.getWorldCoordinates(0, step * iH);\n      let to: IVec = this.getWorldCoordinates(w, step * iH);\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n\n      iH++;\n    }\n\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  drawAxis() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n    if (!this.model.config.axis.show) return;\n\n    ctx.save();\n    ctx.beginPath();\n\n    let h = this.container.height;\n    let w = this.container.width;\n\n    let x_From = this.getWorldCoordinates(0, 0);\n    let x_To = this.getWorldCoordinates(w, 0);\n    let y_From = this.getWorldCoordinates(0, 0);\n    let y_To = this.getWorldCoordinates(0, h);\n\n    ctx.moveTo(0, x_From.y);\n    ctx.lineTo(w, x_To.y);\n\n    ctx.moveTo(y_From.x, 0);\n    ctx.lineTo(y_To.x, h);\n    ctx.strokeStyle = \"red\";\n\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  //TODO: apply scale transformation here\n  getWorldCoordinates(x: number, y: number): IVec {\n    let _this = this;\n\n    let translate = function (vec: IVec): IVec {\n      return {\n        x: vec.x + _this.model.offset.x,\n        y: vec.y + _this.model.offset.y,\n      };\n    }.bind(this);\n\n    let scale = function (vec: IVec): IVec {\n      return {\n        x: vec.x * _this.model.scale.amount,\n        y: vec.y * _this.model.scale.amount,\n      };\n    };\n\n    let t = { x, y };\n    t = translate(t);\n    t = scale(t);\n\n    return t;\n  }\n\n  //x: (x + this.model.offset.x) * this.model.scale.amount * this.model.scale.coord.x,\n  //       y: (y + this.model.offset.y)  * this.model.scale.amount,\n  // getLocalCoordinates(x: number, y: number) {\n  //   return {\n  //     x: (x + this.model.offset.x) * this.model.scale.amount * this.model.scale.coord ,\n  //     y: (y + this.model.offset.y)  * this.model.scale.amount,\n  //   };\n  // }\n\n  initCanvasContainer(): void {\n    if (!this.container) return;\n\n    this.container.style.height = \"600px\";\n    this.container.style.width = \"900px\";\n    this.container.height = 600;\n    this.container.width = 900;\n    this.container.style.border = \"1px solid black\";\n  }\n}\n\nexport default CanvasView;\n","import {default as _2DController} from \"./2d\";\n\nclass App {\n  _2d: _2DController = new _2DController()\n\n\n  run() {}\n}\n\nexport default App\n","import App from './app';\n\nconst app = new App();\n\napp.run();"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvMmQvY29udHJvbGxlcnMvY2FudmFzLmNvbnRyb2xsZXIudHMiLCJhcHAvMmQvaW5kZXgudHMiLCJhcHAvMmQvbW9kZWxzL2NhbnZhcy5tb2RlbC50cyIsImFwcC8yZC92aWV3cy9jYW52YXMudmlldy50cyIsImFwcC9hcHAudHMiLCJhcHAvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQ0FBLElBQUEsZ0JBQUEsZ0JBQUEsUUFBQSxzQkFBQSxDQUFBLENBQUE7QUFDQSxJQUFBLGlCQUFBLGdCQUFBLFFBQUEsd0JBQUEsQ0FBQSxDQUFBO0FBRUEsSUFBQSxtQkFBQSxhQUFBLFlBQUE7QUFJRSxhQUFBLGdCQUFBLEdBQUE7QUFDRSxhQUFLLEtBQUwsR0FBYSxJQUFJLGVBQUEsT0FBSixFQUFiO0FBQ0EsYUFBSyxJQUFMLEdBQVksSUFBSSxjQUFBLE9BQUosQ0FBZSxLQUFLLEtBQXBCLENBQVo7QUFDQSxZQUFJLEtBQUssSUFBTCxDQUFVLFNBQWQsRUFBeUI7QUFDdkIsaUJBQUssSUFBTCxDQUFVLFNBQVYsQ0FBb0IsZ0JBQXBCLENBQ0UsV0FERixFQUVFLEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBb0IsSUFBcEIsQ0FGRjtBQUlBLGlCQUFLLElBQUwsQ0FBVSxTQUFWLENBQW9CLGdCQUFwQixDQUNFLFdBREYsRUFFRSxLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQW9CLElBQXBCLENBRkY7QUFJQSxpQkFBSyxJQUFMLENBQVUsU0FBVixDQUFvQixnQkFBcEIsQ0FBcUMsU0FBckMsRUFBZ0QsS0FBSyxPQUFMLENBQWEsSUFBYixDQUFrQixJQUFsQixDQUFoRDtBQUNBLGlCQUFLLElBQUwsQ0FBVSxTQUFWLENBQW9CLGdCQUFwQixDQUFxQyxPQUFyQyxFQUE4QyxLQUFLLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBcUIsSUFBckIsQ0FBOUM7QUFDRDtBQUNGO0FB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QUosRUFBckI7QUFJRDtBQURDLFFBQUEsU0FBQSxDQUFBLEdBQUEsR0FBQSxZQUFBLENBQVEsQ0FBUjtBQUNGLFdBQUEsR0FBQTtBQUFDLENBTEQsRUFBQTtBQU9BLFFBQUEsT0FBQSxHQUFlLEdBQWY7Ozs7Ozs7OztBQ1RBLElBQUEsUUFBQSxnQkFBQSxRQUFBLE9BQUEsQ0FBQSxDQUFBO0FBRUEsSUFBTSxNQUFNLElBQUksTUFBQSxPQUFKLEVBQVo7QUFFQSxJQUFJLEdBQUoiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgQ2FudmFzVmlldyBmcm9tIFwiLi4vdmlld3MvY2FudmFzLnZpZXdcIjtcbmltcG9ydCBDYW52YXNNb2RlbCBmcm9tIFwiLi4vbW9kZWxzL2NhbnZhcy5tb2RlbFwiO1xuXG5jbGFzcyBDYW52YXNDb250cm9sbGVyIHtcbiAgdmlldzogQ2FudmFzVmlldztcbiAgbW9kZWw6IENhbnZhc01vZGVsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMubW9kZWwgPSBuZXcgQ2FudmFzTW9kZWwoKTtcbiAgICB0aGlzLnZpZXcgPSBuZXcgQ2FudmFzVmlldyh0aGlzLm1vZGVsKTtcbiAgICBpZiAodGhpcy52aWV3LmNvbnRhaW5lcikge1xuICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgICB0aGlzLm1vdXNlTW92ZS5iaW5kKHRoaXMpXG4gICAgICApO1xuICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcIm1vdXNlZG93blwiLFxuICAgICAgICB0aGlzLm1vdXNlRG93bi5iaW5kKHRoaXMpXG4gICAgICApO1xuICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLm1vdXNlVXAuYmluZCh0aGlzKSk7XG4gICAgICB0aGlzLnZpZXcuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCB0aGlzLm1vdXNlV2hlZWwuYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgbW91c2VXaGVlbChlOiBXaGVlbEV2ZW50KSB7XG4gICAgdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQgKz0gLU1hdGguc2lnbihlLmRlbHRhWSkgKiAwLjAxO1xuICAgIHRoaXMubW9kZWwuc2NhbGUuYW1vdW50ID0gTWF0aC5taW4oXG4gICAgICBNYXRoLm1heCgwLjUsIHRoaXMubW9kZWwuc2NhbGUuYW1vdW50KSxcbiAgICAgIDRcbiAgICApO1xuICAgIHRoaXMubW9kZWwuc2NhbGUuY29vcmQgPSB7XG4gICAgICB4OiBlLm9mZnNldFgsXG4gICAgICB5OiBlLm9mZnNldFksXG4gICAgfTtcblxuICAgIGxldCBfZWw6IEhUTUxDYW52YXNFbGVtZW50IHwgbnVsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdG9yXCIpO1xuICAgIGxldCB3LCBoO1xuXG4gICAgaWYgKF9lbCkge1xuICAgICAgdyA9IF9lbC53aWR0aDtcbiAgICAgIGggPSBfZWwuaGVpZ2h0O1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwiLS1cIixcbiAgICAgICAgdyxcbiAgICAgICAgdyAvIHRoaXMubW9kZWwuc2NhbGUuYW1vdW50LFxuICAgICAgICB0aGlzLm1vZGVsLnNjYWxlLmFtb3VudCxcbiAgICAgICAgKHcgLyB0aGlzLm1vZGVsLnNjYWxlLmFtb3VudCAtIHcpICogKGUub2Zmc2V0WCAvIHcpXG4gICAgICApO1xuICAgICAgdGhpcy5tb2RlbC5vZmZzZXQueCArPVxuICAgICAgICAodyAvIHRoaXMubW9kZWwuc2NhbGUuYW1vdW50IC0gdykgKiAoZS5vZmZzZXRYIC8gdyk7XG4gICAgICB0aGlzLm1vZGVsLm9mZnNldC55ICs9XG4gICAgICAgIChoIC8gdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQgLSBoKSAqIChlLm9mZnNldFkgLyBoKTtcbiAgICB9XG5cbiAgICB0aGlzLnZpZXcuZHJhdygpO1xuICB9XG5cbiAgbW91c2VEb3duKGU6IEV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5tb2RlbC5jbGlja2VkID0gdHJ1ZTtcbiAgfVxuXG4gIG1vdXNlTW92ZShlOiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLm1vZGVsLm1vdXNlKSB7XG4gICAgICB0aGlzLm1vZGVsLm1vdXNlID0ge1xuICAgICAgICB4OiBlLm9mZnNldFgsXG4gICAgICAgIHk6IGUub2Zmc2V0WSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubW9kZWwubW91c2UueCA9IGUub2Zmc2V0WDtcbiAgICAgIHRoaXMubW9kZWwubW91c2UueSA9IGUub2Zmc2V0WTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tb2RlbC5jbGlja2VkKSB7XG4gICAgICBpZiAodGhpcy5tb2RlbC5vZmZzZXQpIHtcbiAgICAgICAgdGhpcy5tb2RlbC5vZmZzZXQueCArPSBlLm1vdmVtZW50WDtcbiAgICAgICAgdGhpcy5tb2RlbC5vZmZzZXQueSArPSBlLm1vdmVtZW50WTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubW9kZWwub2Zmc2V0ID0ge1xuICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgeTogMCxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnZpZXcuZHJhdygpO1xuICB9XG5cbiAgbW91c2VVcChlOiBFdmVudCkge1xuICAgIHRoaXMubW9kZWwuY2xpY2tlZCA9IGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhbnZhc0NvbnRyb2xsZXI7XG4iLCJpbXBvcnQgQ2FudmFzQ29udHJvbGxlciBmcm9tIFwiLi9jb250cm9sbGVycy9jYW52YXMuY29udHJvbGxlclwiO1xuXG5jbGFzcyBDb250cm9sbGVyIHtcbiAgICBjYW52YXM6IENhbnZhc0NvbnRyb2xsZXIgPSBuZXcgQ2FudmFzQ29udHJvbGxlcigpXG59XG5cbmV4cG9ydCBkZWZhdWx0IENvbnRyb2xsZXJcbiIsImltcG9ydCB7IElWZWMgfSBmcm9tIFwiLi4vLi4vZ2VvbWV0cnkvdmVjdFwiO1xuXG5jbGFzcyBDYW52YXNNb2RlbCB7XG4gIG1vdXNlOiBJVmVjIHwgbnVsbCA9IG51bGw7XG4gIHNjYWxlOiB7XG4gICAgYW1vdW50OiBudW1iZXIsXG4gICAgY29vcmQ6IElWZWMgfCBudWxsXG4gIH0gPSB7XG4gICAgYW1vdW50OiAxLFxuICAgIGNvb3JkOiBudWxsXG4gIH1cbiAgY2xpY2tlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBrZXlib2FyZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIG9mZnNldDogSVZlYyA9IHsgeDogMCwgeTogMCB9O1xuICBjb25maWc6IElDb25maWcgPSB7XG4gICAgYXhpczoge1xuICAgICAgc2hvdzogdHJ1ZSxcbiAgICB9LFxuICAgIG5ldDoge1xuICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgIHN0ZXA6IDIwLFxuICAgIH0sXG4gIH07XG59XG5cbmludGVyZmFjZSBJQ29uZmlnIHtcbiAgYXhpczoge1xuICAgIHNob3c6IGJvb2xlYW47XG4gIH07XG4gIG5ldDoge1xuICAgIHNob3c6IGJvb2xlYW47XG4gICAgc3RlcDogMTUgfCAyMCB8IDUwO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBDYW52YXNNb2RlbDtcbiIsImltcG9ydCB7IElWZWMgfSBmcm9tIFwiLi4vLi4vZ2VvbWV0cnkvdmVjdFwiO1xuaW1wb3J0IENhbnZhc01vZGVsIGZyb20gXCIuLi9tb2RlbHMvY2FudmFzLm1vZGVsXCI7XG5cbmNsYXNzIENhbnZhc1ZpZXcge1xuICBtb2RlbDogQ2FudmFzTW9kZWw7XG4gIGNvbnRhaW5lcjogSFRNTENhbnZhc0VsZW1lbnQgfCBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKG1vZGVsOiBDYW52YXNNb2RlbCkge1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdG9yXCIpO1xuICAgIHRoaXMuaW5pdCgpO1xuICB9XG5cbiAgaW5pdCgpIHtcbiAgICB0aGlzLmluaXRDYW52YXNDb250YWluZXIoKTtcbiAgfVxuXG4gIGRyYXcoKSB7XG4gICAgdGhpcy5jbGVhcigpO1xuICAgIC8vIHRoaXMuZHJhd05ldCgpO1xuICAgIHRoaXMuZHJhd05ldDEoKTtcbiAgICB0aGlzLmRyYXdBeGlzKCk7XG4gICAgdGhpcy5kcmF3TW91c2UoKTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIGNvbnN0IGN0eCA9IHRoaXMuY29udGFpbmVyPy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgICBpZiAoIWN0eCB8fCAhdGhpcy5tb2RlbC5tb3VzZSB8fCAhdGhpcy5jb250YWluZXIpIHJldHVybjtcblxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jb250YWluZXIud2lkdGgsIHRoaXMuY29udGFpbmVyLmhlaWdodCk7XG4gIH1cblxuICBkcmF3TW91c2UoKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250YWluZXI/LmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4IHx8ICF0aGlzLm1vZGVsLm1vdXNlKSByZXR1cm47XG5cbiAgICBjdHguc2F2ZSgpO1xuXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwicmVkXCI7XG4gICAgY3R4LmxpbmVXaWR0aCA9IDI7XG4gICAgY3R4LmFyYyh0aGlzLm1vZGVsLm1vdXNlLngsIHRoaXMubW9kZWwubW91c2UueSwgMSwgMCwgMiAqIE1hdGguUEkpO1xuXG4gICAgY3R4LnJlc3RvcmUoKTtcbiAgfVxuXG4gIGRyYXdOZXQoKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250YWluZXI/LmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4IHx8ICF0aGlzLm1vZGVsLm1vdXNlIHx8ICF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuICAgIGlmICghdGhpcy5tb2RlbC5jb25maWcubmV0LnNob3cpIHJldHVybjtcblxuICAgIGN0eC5zYXZlKCk7XG5cbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4LmxpbmVXaWR0aCA9IDE7XG5cbiAgICBsZXQgc3RlcCA9IHRoaXMubW9kZWwuY29uZmlnLm5ldC5zdGVwICogdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQ7XG4gICAgbGV0IGggPSB0aGlzLmNvbnRhaW5lci5oZWlnaHQ7XG4gICAgbGV0IHcgPSB0aGlzLmNvbnRhaW5lci53aWR0aDtcbiAgICBsZXQgbmV0T2Zmc2V0OiBJVmVjID0ge1xuICAgICAgeDogdGhpcy5tb2RlbC5vZmZzZXQueCAlIHN0ZXAsXG4gICAgICB5OiB0aGlzLm1vZGVsLm9mZnNldC55ICUgc3RlcCxcbiAgICB9O1xuXG4gICAgLy94XG4gICAgbGV0IGlWID0gMDtcbiAgICBsZXQgbWF4ViA9IHcgLyBzdGVwO1xuICAgIHdoaWxlIChpViA8PSBtYXhWKSB7XG4gICAgICBsZXQgZnJvbTogSVZlYyA9IHsgeDogc3RlcCAqIGlWICsgbmV0T2Zmc2V0LngsIHk6IDAgfTtcbiAgICAgIGxldCB0bzogSVZlYyA9IHsgeDogc3RlcCAqIGlWICsgbmV0T2Zmc2V0LngsIHk6IGggfTtcblxuICAgICAgY3R4Lm1vdmVUbyhmcm9tLngsIGZyb20ueSk7XG4gICAgICBjdHgubGluZVRvKHRvLngsIHRvLnkpO1xuICAgICAgaVYrKztcbiAgICB9XG5cbiAgICAvL3lcbiAgICBsZXQgaUggPSAwO1xuICAgIGxldCBtYXhIID0gaCAvIHN0ZXA7XG4gICAgd2hpbGUgKGlIIDw9IG1heEgpIHtcbiAgICAgIGxldCBmcm9tOiBJVmVjID0geyB4OiAwLCB5OiBzdGVwICogaUggKyBuZXRPZmZzZXQueSB9O1xuICAgICAgbGV0IHRvOiBJVmVjID0geyB4OiB3LCB5OiBzdGVwICogaUggKyBuZXRPZmZzZXQueSB9O1xuXG4gICAgICBjdHgubW92ZVRvKGZyb20ueCwgZnJvbS55KTtcbiAgICAgIGN0eC5saW5lVG8odG8ueCwgdG8ueSk7XG5cbiAgICAgIGlIKys7XG4gICAgfVxuXG4gICAgY3R4LnN0cm9rZSgpO1xuICAgIGN0eC5yZXN0b3JlKCk7XG4gIH1cblxuICBkcmF3TmV0MSgpIHtcbiAgICBjb25zdCBjdHggPSB0aGlzLmNvbnRhaW5lcj8uZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gICAgaWYgKCFjdHggfHwgIXRoaXMubW9kZWwubW91c2UgfHwgIXRoaXMuY29udGFpbmVyKSByZXR1cm47XG4gICAgaWYgKCF0aGlzLm1vZGVsLmNvbmZpZy5uZXQuc2hvdykgcmV0dXJuO1xuXG4gICAgY3R4LnNhdmUoKTtcblxuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICBjdHgubGluZVdpZHRoID0gMTtcblxuICAgIGxldCBzdGVwID0gdGhpcy5tb2RlbC5jb25maWcubmV0LnN0ZXAgKiB0aGlzLm1vZGVsLnNjYWxlLmFtb3VudDtcbiAgICBsZXQgaCA9IHRoaXMuY29udGFpbmVyLmhlaWdodDtcbiAgICBsZXQgdyA9IHRoaXMuY29udGFpbmVyLndpZHRoO1xuXG4gICAgLy94XG4gICAgbGV0IGlWID0gMDtcbiAgICBsZXQgbWF4ViA9IHcgLyBzdGVwO1xuICAgIHdoaWxlIChpViA8PSBtYXhWKSB7XG4gICAgICBsZXQgZnJvbTogSVZlYyA9IHRoaXMuZ2V0V29ybGRDb29yZGluYXRlcyhzdGVwICogaVYsIDApO1xuICAgICAgbGV0IHRvOiBJVmVjID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKHN0ZXAgKiBpViwgaCk7XG5cbiAgICAgIGN0eC5tb3ZlVG8oZnJvbS54LCBmcm9tLnkpO1xuICAgICAgY3R4LmxpbmVUbyh0by54LCB0by55KTtcbiAgICAgIGlWKys7XG4gICAgfVxuXG4gICAgLy95XG4gICAgbGV0IGlIID0gMDtcbiAgICBsZXQgbWF4SCA9IGggLyBzdGVwO1xuICAgIHdoaWxlIChpSCA8PSBtYXhIKSB7XG4gICAgICBsZXQgZnJvbTogSVZlYyA9IHRoaXMuZ2V0V29ybGRDb29yZGluYXRlcygwLCBzdGVwICogaUgpO1xuICAgICAgbGV0IHRvOiBJVmVjID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKHcsIHN0ZXAgKiBpSCk7XG5cbiAgICAgIGN0eC5tb3ZlVG8oZnJvbS54LCBmcm9tLnkpO1xuICAgICAgY3R4LmxpbmVUbyh0by54LCB0by55KTtcblxuICAgICAgaUgrKztcbiAgICB9XG5cbiAgICBjdHguc3Ryb2tlKCk7XG4gICAgY3R4LnJlc3RvcmUoKTtcbiAgfVxuXG4gIGRyYXdBeGlzKCkge1xuICAgIGNvbnN0IGN0eCA9IHRoaXMuY29udGFpbmVyPy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgICBpZiAoIWN0eCB8fCAhdGhpcy5tb2RlbC5tb3VzZSB8fCAhdGhpcy5jb250YWluZXIpIHJldHVybjtcbiAgICBpZiAoIXRoaXMubW9kZWwuY29uZmlnLmF4aXMuc2hvdykgcmV0dXJuO1xuXG4gICAgY3R4LnNhdmUoKTtcbiAgICBjdHguYmVnaW5QYXRoKCk7XG5cbiAgICBsZXQgaCA9IHRoaXMuY29udGFpbmVyLmhlaWdodDtcbiAgICBsZXQgdyA9IHRoaXMuY29udGFpbmVyLndpZHRoO1xuXG4gICAgbGV0IHhfRnJvbSA9IHRoaXMuZ2V0V29ybGRDb29yZGluYXRlcygwLCAwKTtcbiAgICBsZXQgeF9UbyA9IHRoaXMuZ2V0V29ybGRDb29yZGluYXRlcyh3LCAwKTtcbiAgICBsZXQgeV9Gcm9tID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKDAsIDApO1xuICAgIGxldCB5X1RvID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKDAsIGgpO1xuXG4gICAgY3R4Lm1vdmVUbygwLCB4X0Zyb20ueSk7XG4gICAgY3R4LmxpbmVUbyh3LCB4X1RvLnkpO1xuXG4gICAgY3R4Lm1vdmVUbyh5X0Zyb20ueCwgMCk7XG4gICAgY3R4LmxpbmVUbyh5X1RvLngsIGgpO1xuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwicmVkXCI7XG5cbiAgICBjdHguc3Ryb2tlKCk7XG4gICAgY3R4LnJlc3RvcmUoKTtcbiAgfVxuXG4gIC8vVE9ETzogYXBwbHkgc2NhbGUgdHJhbnNmb3JtYXRpb24gaGVyZVxuICBnZXRXb3JsZENvb3JkaW5hdGVzKHg6IG51bWJlciwgeTogbnVtYmVyKTogSVZlYyB7XG4gICAgbGV0IF90aGlzID0gdGhpcztcblxuICAgIGxldCB0cmFuc2xhdGUgPSBmdW5jdGlvbiAodmVjOiBJVmVjKTogSVZlYyB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiB2ZWMueCArIF90aGlzLm1vZGVsLm9mZnNldC54LFxuICAgICAgICB5OiB2ZWMueSArIF90aGlzLm1vZGVsLm9mZnNldC55LFxuICAgICAgfTtcbiAgICB9LmJpbmQodGhpcyk7XG5cbiAgICBsZXQgc2NhbGUgPSBmdW5jdGlvbiAodmVjOiBJVmVjKTogSVZlYyB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiB2ZWMueCAqIF90aGlzLm1vZGVsLnNjYWxlLmFtb3VudCxcbiAgICAgICAgeTogdmVjLnkgKiBfdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQsXG4gICAgICB9O1xuICAgIH07XG5cbiAgICBsZXQgdCA9IHsgeCwgeSB9O1xuICAgIHQgPSB0cmFuc2xhdGUodCk7XG4gICAgdCA9IHNjYWxlKHQpO1xuXG4gICAgcmV0dXJuIHQ7XG4gIH1cblxuICAvL3g6ICh4ICsgdGhpcy5tb2RlbC5vZmZzZXQueCkgKiB0aGlzLm1vZGVsLnNjYWxlLmFtb3VudCAqIHRoaXMubW9kZWwuc2NhbGUuY29vcmQueCxcbiAgLy8gICAgICAgeTogKHkgKyB0aGlzLm1vZGVsLm9mZnNldC55KSAgKiB0aGlzLm1vZGVsLnNjYWxlLmFtb3VudCxcbiAgLy8gZ2V0TG9jYWxDb29yZGluYXRlcyh4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAvLyAgIHJldHVybiB7XG4gIC8vICAgICB4OiAoeCArIHRoaXMubW9kZWwub2Zmc2V0LngpICogdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQgKiB0aGlzLm1vZGVsLnNjYWxlLmNvb3JkICxcbiAgLy8gICAgIHk6ICh5ICsgdGhpcy5tb2RlbC5vZmZzZXQueSkgICogdGhpcy5tb2RlbC5zY2FsZS5hbW91bnQsXG4gIC8vICAgfTtcbiAgLy8gfVxuXG4gIGluaXRDYW52YXNDb250YWluZXIoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuXG4gICAgdGhpcy5jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCI2MDBweFwiO1xuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLndpZHRoID0gXCI5MDBweFwiO1xuICAgIHRoaXMuY29udGFpbmVyLmhlaWdodCA9IDYwMDtcbiAgICB0aGlzLmNvbnRhaW5lci53aWR0aCA9IDkwMDtcbiAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSBcIjFweCBzb2xpZCBibGFja1wiO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhbnZhc1ZpZXc7XG4iLCJpbXBvcnQge2RlZmF1bHQgYXMgXzJEQ29udHJvbGxlcn0gZnJvbSBcIi4vMmRcIjtcblxuY2xhc3MgQXBwIHtcbiAgXzJkOiBfMkRDb250cm9sbGVyID0gbmV3IF8yRENvbnRyb2xsZXIoKVxuXG5cbiAgcnVuKCkge31cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBwXG4iLCJpbXBvcnQgQXBwIGZyb20gJy4vYXBwJztcblxuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuXG5hcHAucnVuKCk7Il19"}