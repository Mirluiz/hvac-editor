{"version":3,"sources":["node_modules/browser-pack/_prelude.js","app/2d/controllers/canvas.controller.ts","app/2d/index.ts","app/2d/models/canvas.model.ts","app/2d/views/canvas.view.ts","app/app.ts","app/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import CanvasView from \"../views/canvas.view\";\nimport CanvasModel from \"../models/canvas.model\";\n\nclass CanvasController {\n    view: CanvasView\n    model: CanvasModel\n\n    constructor() {\n        this.model = new CanvasModel();\n        this.view = new CanvasView(this.model)\n        if (this.view.container){\n            this.view.container.addEventListener('mousemove', this.mouseMove.bind(this));\n            this.view.container.addEventListener('mousedown', this.mouseDown.bind(this));\n            this.view.container.addEventListener('mouseup', this.mouseUp.bind(this));\n        }\n    }\n\n    mouseDown(e: Event): void {\n        this.model.clicked = true;\n    }\n\n    mouseMove(e: MouseEvent): void {\n\n\n        if (!this.model.mouse){\n            this.model.mouse = {\n                x: e.offsetX,\n                y: e.offsetY\n            }\n        } else {\n            this.model.mouse.x = e.offsetX;\n            this.model.mouse.y = e.offsetY;\n        }\n\n        if (this.model.clicked){\n            if(this.model.offset){\n                this.model.offset.x += e.movementX;\n                this.model.offset.y += e.movementY;\n            } else {\n                this.model.offset = {\n                    x: 0,\n                    y: 0\n                }\n            }\n        }\n\n        this.view.draw();\n    }\n\n    mouseUp(e: Event) {\n        this.model.clicked = false;\n    }\n\n}\n\nexport default CanvasController;\n","import CanvasController from \"./controllers/canvas.controller\";\n\nclass Controller {\n    canvas: CanvasController = new CanvasController()\n}\n\nexport default Controller\n","import { IVec } from \"../../Geometry/vect\";\n\nclass CanvasModel {\n  mouse: IVec | null = null;\n  clicked: boolean = false;\n  keyboard: string | null = null;\n  offset: IVec = { x: 0, y: 0 };\n  config: IConfig = {\n    axis: {\n      show: true,\n    },\n    net: {\n      show: true,\n      step: 20,\n    },\n  };\n}\n\ninterface IConfig {\n  axis: {\n    show: boolean;\n  };\n  net: {\n    show: boolean;\n    step: 15 | 20 | 50;\n  };\n}\n\nexport default CanvasModel;\n","import { IVec } from \"../../Geometry/vect\";\nimport CanvasModel from \"../models/canvas.model\";\n\nclass CanvasView {\n  model: CanvasModel;\n  container: HTMLCanvasElement | null;\n\n  constructor(model: CanvasModel) {\n    this.model = model;\n    this.container = document.querySelector(\"#editor\");\n    this.init();\n  }\n\n  init() {\n    this.initCanvasContainer();\n  }\n\n  draw() {\n    this.clear();\n    this.drawNet();\n    this.drawAxis();\n    this.drawMouse();\n  }\n\n  clear() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n\n    ctx.clearRect(0, 0, this.container.width, this.container.height);\n  }\n\n  drawMouse() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse) return;\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.strokeStyle = \"red\";\n    ctx.lineWidth = 2;\n    ctx.arc(this.model.mouse.x, this.model.mouse.y, 1, 0, 2 * Math.PI);\n\n    ctx.restore();\n  }\n\n  drawNet() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n    if (!this.model.config.net.show) return;\n\n    ctx.save();\n\n    ctx.beginPath();\n    ctx.lineWidth = 1;\n\n    let step = this.model.config.net.step;\n    let h = this.container.height;\n    let w = this.container.width;\n    let netOffset: IVec = {\n      x: this.model.offset.x % step,\n      y: this.model.offset.y % step,\n    };\n\n    //x\n    let iV = 0;\n    let maxV = w / step;\n    while (iV <= maxV) {\n      let from: IVec = { x: step * iV + netOffset.x, y: 0 };\n      let to: IVec = { x: step * iV + netOffset.x, y: h };\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n      iV++;\n    }\n\n    //y\n    let iH = 0;\n    let maxH = h / step;\n    while (iH <= maxH) {\n      let from: IVec = { x: 0, y: step * iH + netOffset.y };\n      let to: IVec = { x: w, y: step * iH + netOffset.y };\n\n      ctx.moveTo(from.x, from.y);\n      ctx.lineTo(to.x, to.y);\n\n      iH++;\n    }\n\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  drawAxis() {\n    const ctx = this.container?.getContext(\"2d\");\n\n    if (!ctx || !this.model.mouse || !this.container) return;\n    if (!this.model.config.axis.show) return;\n\n    ctx.save();\n    ctx.beginPath();\n\n    let h = this.container.height;\n    let w = this.container.width;\n\n    let x_From = this.getWorldCoordinates(0, 0);\n    let x_To = this.getWorldCoordinates(w, 0);\n    let y_From = this.getWorldCoordinates(0, 0);\n    let y_To = this.getWorldCoordinates(0, h);\n\n    ctx.moveTo(0, x_From.y);\n    ctx.lineTo(w, x_To.y);\n\n    ctx.moveTo(y_From.x, 0);\n    ctx.lineTo(y_To.x, h);\n    ctx.strokeStyle = \"red\";\n\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  //TODO: apply scale transformation here\n  getWorldCoordinates(x: number, y: number): IVec {\n    return {\n      x: x + this.model.offset.x,\n      y: y + this.model.offset.y,\n    };\n  }\n\n  getLocalCoordinates(x: number, y: number) {\n    return {\n      x: x + this.model.offset.x,\n      y: y + this.model.offset.y,\n    };\n  }\n\n  initCanvasContainer(): void {\n    if (!this.container) return;\n\n    this.container.style.height = \"600px\";\n    this.container.style.width = \"900px\";\n    this.container.height = 600;\n    this.container.width = 900;\n    this.container.style.border = \"1px solid black\";\n  }\n}\n\nexport default CanvasView;\n","import {default as _2DController} from \"./2d\";\n\nclass App {\n  _2d: _2DController = new _2DController()\n\n\n  run() {}\n}\n\nexport default App\n","import App from './app';\n\nconst app = new App();\n\napp.run();"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvMmQvY29udHJvbGxlcnMvY2FudmFzLmNvbnRyb2xsZXIudHMiLCJhcHAvMmQvaW5kZXgudHMiLCJhcHAvMmQvbW9kZWxzL2NhbnZhcy5tb2RlbC50cyIsImFwcC8yZC92aWV3cy9jYW52YXMudmlldy50cyIsImFwcC9hcHAudHMiLCJhcHAvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQ0FBLElBQUEsZ0JBQUEsZ0JBQUEsUUFBQSxzQkFBQSxDQUFBLENBQUE7QUFDQSxJQUFBLGlCQUFBLGdCQUFBLFFBQUEsd0JBQUEsQ0FBQSxDQUFBO0FBRUEsSUFBQSxtQkFBQSxhQUFBLFlBQUE7QUFJSSxhQUFBLGdCQUFBLEdBQUE7QUFDSSxhQUFLLEtBQUwsR0FBYSxJQUFJLGVBQUEsT0FBSixFQUFiO0FBQ0EsYUFBSyxJQUFMLEdBQVksSUFBSSxjQUFBLE9BQUosQ0FBZSxLQUFLLEtBQXBCLENBQVo7QUFDQSxZQUFJLEtBQUssSUFBTCxDQUFVLFNBQWQsRUFBd0I7QUFDcEIsaUJBQUssSUFBTCxDQUFVLFNBQVYsQ0FBb0IsZ0JBQXBCLENBQXFDLFdBQXJDLEVBQWtELEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBb0IsSUFBcEIsQ0FBbEQ7QUFDQSxpQkFBSyxJQUFMLENBQVUsU0FBVixDQUFvQixnQkFBcEIsQ0FBcUMsV0FBckMsRUFBa0QsS0FBSyxTQUFMLENBQWUsSUFBZixDQUFvQixJQUFwQixDQUFsRDtBQUNBLGlCQUFLLElBQUwsQ0FBVSxTQUFWLENBQW9CLGdCQUFwQixDQUFxQyxTQUFyQyxFQUFnRCxLQUFLLE9BQUwsQ0FBYSxJQUFiLENBQWtCLElBQWxCLENBQWhEO0FBQ0g7QUFDSjtBQUVELHFCQUFBLFNBQUEsQ0FBQSxTQUFBLEdBQUEsVUFBVSxDQUFWLEVBQWtCO0FBQ2QsYUFBSyxLQUFMLENBQVcsT0FBWCxHQUFxQixJQUFyQjtBQUNILEtB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QUFBQSxhQUFBLEdBQUEsR0FBQTtBQUNFLGFBQUEsR0FBQSxHQUFxQixJQUFJLE1BQUEsT0FBSixFQUFyQjtBQUlEO0FBREMsUUFBQSxTQUFBLENBQUEsR0FBQSxHQUFBLFlBQUEsQ0FBUSxDQUFSO0FBQ0YsV0FBQSxHQUFBO0FBQUMsQ0FMRCxFQUFBO0FBT0EsUUFBQSxPQUFBLEdBQWUsR0FBZjs7Ozs7Ozs7O0FDVEEsSUFBQSxRQUFBLGdCQUFBLFFBQUEsT0FBQSxDQUFBLENBQUE7QUFFQSxJQUFNLE1BQU0sSUFBSSxNQUFBLE9BQUosRUFBWjtBQUVBLElBQUksR0FBSiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCBDYW52YXNWaWV3IGZyb20gXCIuLi92aWV3cy9jYW52YXMudmlld1wiO1xuaW1wb3J0IENhbnZhc01vZGVsIGZyb20gXCIuLi9tb2RlbHMvY2FudmFzLm1vZGVsXCI7XG5cbmNsYXNzIENhbnZhc0NvbnRyb2xsZXIge1xuICAgIHZpZXc6IENhbnZhc1ZpZXdcbiAgICBtb2RlbDogQ2FudmFzTW9kZWxcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IENhbnZhc01vZGVsKCk7XG4gICAgICAgIHRoaXMudmlldyA9IG5ldyBDYW52YXNWaWV3KHRoaXMubW9kZWwpXG4gICAgICAgIGlmICh0aGlzLnZpZXcuY29udGFpbmVyKXtcbiAgICAgICAgICAgIHRoaXMudmlldy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3VzZU1vdmUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLnZpZXcuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMubW91c2VEb3duLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy52aWV3LmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5tb3VzZVVwLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbW91c2VEb3duKGU6IEV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMubW9kZWwuY2xpY2tlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgbW91c2VNb3ZlKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcblxuXG4gICAgICAgIGlmICghdGhpcy5tb2RlbC5tb3VzZSl7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLm1vdXNlID0ge1xuICAgICAgICAgICAgICAgIHg6IGUub2Zmc2V0WCxcbiAgICAgICAgICAgICAgICB5OiBlLm9mZnNldFlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwubW91c2UueCA9IGUub2Zmc2V0WDtcbiAgICAgICAgICAgIHRoaXMubW9kZWwubW91c2UueSA9IGUub2Zmc2V0WTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm1vZGVsLmNsaWNrZWQpe1xuICAgICAgICAgICAgaWYodGhpcy5tb2RlbC5vZmZzZXQpe1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwub2Zmc2V0LnggKz0gZS5tb3ZlbWVudFg7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5vZmZzZXQueSArPSBlLm1vdmVtZW50WTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5vZmZzZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICAgICAgICAgIHk6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnZpZXcuZHJhdygpO1xuICAgIH1cblxuICAgIG1vdXNlVXAoZTogRXZlbnQpIHtcbiAgICAgICAgdGhpcy5tb2RlbC5jbGlja2VkID0gZmFsc2U7XG4gICAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IENhbnZhc0NvbnRyb2xsZXI7XG4iLCJpbXBvcnQgQ2FudmFzQ29udHJvbGxlciBmcm9tIFwiLi9jb250cm9sbGVycy9jYW52YXMuY29udHJvbGxlclwiO1xuXG5jbGFzcyBDb250cm9sbGVyIHtcbiAgICBjYW52YXM6IENhbnZhc0NvbnRyb2xsZXIgPSBuZXcgQ2FudmFzQ29udHJvbGxlcigpXG59XG5cbmV4cG9ydCBkZWZhdWx0IENvbnRyb2xsZXJcbiIsImltcG9ydCB7IElWZWMgfSBmcm9tIFwiLi4vLi4vR2VvbWV0cnkvdmVjdFwiO1xuXG5jbGFzcyBDYW52YXNNb2RlbCB7XG4gIG1vdXNlOiBJVmVjIHwgbnVsbCA9IG51bGw7XG4gIGNsaWNrZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAga2V5Ym9hcmQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBvZmZzZXQ6IElWZWMgPSB7IHg6IDAsIHk6IDAgfTtcbiAgY29uZmlnOiBJQ29uZmlnID0ge1xuICAgIGF4aXM6IHtcbiAgICAgIHNob3c6IHRydWUsXG4gICAgfSxcbiAgICBuZXQ6IHtcbiAgICAgIHNob3c6IHRydWUsXG4gICAgICBzdGVwOiAyMCxcbiAgICB9LFxuICB9O1xufVxuXG5pbnRlcmZhY2UgSUNvbmZpZyB7XG4gIGF4aXM6IHtcbiAgICBzaG93OiBib29sZWFuO1xuICB9O1xuICBuZXQ6IHtcbiAgICBzaG93OiBib29sZWFuO1xuICAgIHN0ZXA6IDE1IHwgMjAgfCA1MDtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FudmFzTW9kZWw7XG4iLCJpbXBvcnQgeyBJVmVjIH0gZnJvbSBcIi4uLy4uL0dlb21ldHJ5L3ZlY3RcIjtcbmltcG9ydCBDYW52YXNNb2RlbCBmcm9tIFwiLi4vbW9kZWxzL2NhbnZhcy5tb2RlbFwiO1xuXG5jbGFzcyBDYW52YXNWaWV3IHtcbiAgbW9kZWw6IENhbnZhc01vZGVsO1xuICBjb250YWluZXI6IEhUTUxDYW52YXNFbGVtZW50IHwgbnVsbDtcblxuICBjb25zdHJ1Y3Rvcihtb2RlbDogQ2FudmFzTW9kZWwpIHtcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRvclwiKTtcbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5pbml0Q2FudmFzQ29udGFpbmVyKCk7XG4gIH1cblxuICBkcmF3KCkge1xuICAgIHRoaXMuY2xlYXIoKTtcbiAgICB0aGlzLmRyYXdOZXQoKTtcbiAgICB0aGlzLmRyYXdBeGlzKCk7XG4gICAgdGhpcy5kcmF3TW91c2UoKTtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIGNvbnN0IGN0eCA9IHRoaXMuY29udGFpbmVyPy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgICBpZiAoIWN0eCB8fCAhdGhpcy5tb2RlbC5tb3VzZSB8fCAhdGhpcy5jb250YWluZXIpIHJldHVybjtcblxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jb250YWluZXIud2lkdGgsIHRoaXMuY29udGFpbmVyLmhlaWdodCk7XG4gIH1cblxuICBkcmF3TW91c2UoKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250YWluZXI/LmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4IHx8ICF0aGlzLm1vZGVsLm1vdXNlKSByZXR1cm47XG5cbiAgICBjdHguc2F2ZSgpO1xuXG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwicmVkXCI7XG4gICAgY3R4LmxpbmVXaWR0aCA9IDI7XG4gICAgY3R4LmFyYyh0aGlzLm1vZGVsLm1vdXNlLngsIHRoaXMubW9kZWwubW91c2UueSwgMSwgMCwgMiAqIE1hdGguUEkpO1xuXG4gICAgY3R4LnJlc3RvcmUoKTtcbiAgfVxuXG4gIGRyYXdOZXQoKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250YWluZXI/LmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4IHx8ICF0aGlzLm1vZGVsLm1vdXNlIHx8ICF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuICAgIGlmICghdGhpcy5tb2RlbC5jb25maWcubmV0LnNob3cpIHJldHVybjtcblxuICAgIGN0eC5zYXZlKCk7XG5cbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4LmxpbmVXaWR0aCA9IDE7XG5cbiAgICBsZXQgc3RlcCA9IHRoaXMubW9kZWwuY29uZmlnLm5ldC5zdGVwO1xuICAgIGxldCBoID0gdGhpcy5jb250YWluZXIuaGVpZ2h0O1xuICAgIGxldCB3ID0gdGhpcy5jb250YWluZXIud2lkdGg7XG4gICAgbGV0IG5ldE9mZnNldDogSVZlYyA9IHtcbiAgICAgIHg6IHRoaXMubW9kZWwub2Zmc2V0LnggJSBzdGVwLFxuICAgICAgeTogdGhpcy5tb2RlbC5vZmZzZXQueSAlIHN0ZXAsXG4gICAgfTtcblxuICAgIC8veFxuICAgIGxldCBpViA9IDA7XG4gICAgbGV0IG1heFYgPSB3IC8gc3RlcDtcbiAgICB3aGlsZSAoaVYgPD0gbWF4Vikge1xuICAgICAgbGV0IGZyb206IElWZWMgPSB7IHg6IHN0ZXAgKiBpViArIG5ldE9mZnNldC54LCB5OiAwIH07XG4gICAgICBsZXQgdG86IElWZWMgPSB7IHg6IHN0ZXAgKiBpViArIG5ldE9mZnNldC54LCB5OiBoIH07XG5cbiAgICAgIGN0eC5tb3ZlVG8oZnJvbS54LCBmcm9tLnkpO1xuICAgICAgY3R4LmxpbmVUbyh0by54LCB0by55KTtcbiAgICAgIGlWKys7XG4gICAgfVxuXG4gICAgLy95XG4gICAgbGV0IGlIID0gMDtcbiAgICBsZXQgbWF4SCA9IGggLyBzdGVwO1xuICAgIHdoaWxlIChpSCA8PSBtYXhIKSB7XG4gICAgICBsZXQgZnJvbTogSVZlYyA9IHsgeDogMCwgeTogc3RlcCAqIGlIICsgbmV0T2Zmc2V0LnkgfTtcbiAgICAgIGxldCB0bzogSVZlYyA9IHsgeDogdywgeTogc3RlcCAqIGlIICsgbmV0T2Zmc2V0LnkgfTtcblxuICAgICAgY3R4Lm1vdmVUbyhmcm9tLngsIGZyb20ueSk7XG4gICAgICBjdHgubGluZVRvKHRvLngsIHRvLnkpO1xuXG4gICAgICBpSCsrO1xuICAgIH1cblxuICAgIGN0eC5zdHJva2UoKTtcbiAgICBjdHgucmVzdG9yZSgpO1xuICB9XG5cbiAgZHJhd0F4aXMoKSB7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5jb250YWluZXI/LmdldENvbnRleHQoXCIyZFwiKTtcblxuICAgIGlmICghY3R4IHx8ICF0aGlzLm1vZGVsLm1vdXNlIHx8ICF0aGlzLmNvbnRhaW5lcikgcmV0dXJuO1xuICAgIGlmICghdGhpcy5tb2RlbC5jb25maWcuYXhpcy5zaG93KSByZXR1cm47XG5cbiAgICBjdHguc2F2ZSgpO1xuICAgIGN0eC5iZWdpblBhdGgoKTtcblxuICAgIGxldCBoID0gdGhpcy5jb250YWluZXIuaGVpZ2h0O1xuICAgIGxldCB3ID0gdGhpcy5jb250YWluZXIud2lkdGg7XG5cbiAgICBsZXQgeF9Gcm9tID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKDAsIDApO1xuICAgIGxldCB4X1RvID0gdGhpcy5nZXRXb3JsZENvb3JkaW5hdGVzKHcsIDApO1xuICAgIGxldCB5X0Zyb20gPSB0aGlzLmdldFdvcmxkQ29vcmRpbmF0ZXMoMCwgMCk7XG4gICAgbGV0IHlfVG8gPSB0aGlzLmdldFdvcmxkQ29vcmRpbmF0ZXMoMCwgaCk7XG5cbiAgICBjdHgubW92ZVRvKDAsIHhfRnJvbS55KTtcbiAgICBjdHgubGluZVRvKHcsIHhfVG8ueSk7XG5cbiAgICBjdHgubW92ZVRvKHlfRnJvbS54LCAwKTtcbiAgICBjdHgubGluZVRvKHlfVG8ueCwgaCk7XG4gICAgY3R4LnN0cm9rZVN0eWxlID0gXCJyZWRcIjtcblxuICAgIGN0eC5zdHJva2UoKTtcbiAgICBjdHgucmVzdG9yZSgpO1xuICB9XG5cbiAgLy9UT0RPOiBhcHBseSBzY2FsZSB0cmFuc2Zvcm1hdGlvbiBoZXJlXG4gIGdldFdvcmxkQ29vcmRpbmF0ZXMoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBJVmVjIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDogeCArIHRoaXMubW9kZWwub2Zmc2V0LngsXG4gICAgICB5OiB5ICsgdGhpcy5tb2RlbC5vZmZzZXQueSxcbiAgICB9O1xuICB9XG5cbiAgZ2V0TG9jYWxDb29yZGluYXRlcyh4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgIHJldHVybiB7XG4gICAgICB4OiB4ICsgdGhpcy5tb2RlbC5vZmZzZXQueCxcbiAgICAgIHk6IHkgKyB0aGlzLm1vZGVsLm9mZnNldC55LFxuICAgIH07XG4gIH1cblxuICBpbml0Q2FudmFzQ29udGFpbmVyKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb250YWluZXIpIHJldHVybjtcblxuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IFwiNjAwcHhcIjtcbiAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS53aWR0aCA9IFwiOTAwcHhcIjtcbiAgICB0aGlzLmNvbnRhaW5lci5oZWlnaHQgPSA2MDA7XG4gICAgdGhpcy5jb250YWluZXIud2lkdGggPSA5MDA7XG4gICAgdGhpcy5jb250YWluZXIuc3R5bGUuYm9yZGVyID0gXCIxcHggc29saWQgYmxhY2tcIjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYW52YXNWaWV3O1xuIiwiaW1wb3J0IHtkZWZhdWx0IGFzIF8yRENvbnRyb2xsZXJ9IGZyb20gXCIuLzJkXCI7XG5cbmNsYXNzIEFwcCB7XG4gIF8yZDogXzJEQ29udHJvbGxlciA9IG5ldyBfMkRDb250cm9sbGVyKClcblxuXG4gIHJ1bigpIHt9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwcFxuIiwiaW1wb3J0IEFwcCBmcm9tICcuL2FwcCc7XG5cbmNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcblxuYXBwLnJ1bigpOyJdfQ=="}